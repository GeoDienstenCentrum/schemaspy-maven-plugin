<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HtmlAnomaliesPage.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">SchemaSpy Maven Plugin</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.schemaspy.view</a> &gt; <span class="el_source">HtmlAnomaliesPage.java</span></div><h1>HtmlAnomaliesPage.java</h1><pre class="source lang-java linenums">/*
 * This file is a part of the SchemaSpy project (http://schemaspy.sourceforge.net).
 * Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010 John Currier
 *
 * SchemaSpy is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * SchemaSpy is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 */
package net.sourceforge.schemaspy.view;

import java.io.IOException;
import java.text.NumberFormat;
import java.util.Collection;
import java.util.HashSet;
import java.util.List;
import net.sourceforge.schemaspy.DbAnalyzer;
import net.sourceforge.schemaspy.model.Database;
import net.sourceforge.schemaspy.model.ForeignKeyConstraint;
import net.sourceforge.schemaspy.model.Table;
import net.sourceforge.schemaspy.model.TableColumn;
import net.sourceforge.schemaspy.util.HtmlEncoder;
import net.sourceforge.schemaspy.util.LineWriter;

/**
 * This page lists all of the 'things that might not be quite right'
 * about the schema.
 *
 * @author John Currier
 */
public class HtmlAnomaliesPage extends HtmlFormatter {
<span class="fc" id="L41">    private static HtmlAnomaliesPage instance = new HtmlAnomaliesPage();</span>

    /**
     * Singleton: Don't allow instantiation
     */
    private HtmlAnomaliesPage() {
    }

    /**
     * Singleton accessor
     *
     * @return the singleton instance
     */
    public static HtmlAnomaliesPage getInstance() {
<span class="fc" id="L55">        return instance;</span>
    }

    public void write(Database database, Collection&lt;Table&gt; tables, List&lt;? extends ForeignKeyConstraint&gt; impliedConstraints, boolean hasOrphans, LineWriter out) throws IOException {
<span class="fc" id="L59">        writeHeader(database, hasOrphans, out);</span>
<span class="fc" id="L60">        writeImpliedConstraints(impliedConstraints, out);</span>
<span class="fc" id="L61">        writeTablesWithoutIndexes(DbAnalyzer.getTablesWithoutIndexes(new HashSet&lt;Table&gt;(tables)), out);</span>
<span class="fc" id="L62">        writeUniqueNullables(DbAnalyzer.getMustBeUniqueNullableColumns(new HashSet&lt;Table&gt;(tables)), out);</span>
<span class="fc" id="L63">        writeTablesWithOneColumn(DbAnalyzer.getTablesWithOneColumn(tables), out);</span>
<span class="fc" id="L64">        writeTablesWithIncrementingColumnNames(DbAnalyzer.getTablesWithIncrementingColumnNames(tables), out);</span>
<span class="fc" id="L65">        writeDefaultNullStrings(DbAnalyzer.getDefaultNullStringColumns(new HashSet&lt;Table&gt;(tables)), out);</span>
<span class="fc" id="L66">        writeFooter(out);</span>
<span class="fc" id="L67">    }</span>

    private void writeHeader(Database database, boolean hasOrphans, LineWriter html) throws IOException {
<span class="fc" id="L70">        writeHeader(database, null, &quot;Anomalies&quot;, hasOrphans, html);</span>
<span class="fc" id="L71">        html.writeln(&quot;&lt;table width='100%'&gt;&quot;);</span>
<span class="pc bpc" id="L72" title="1 of 2 branches missed.">        if (sourceForgeLogoEnabled())</span>
<span class="fc" id="L73">            html.writeln(&quot;  &lt;tr&gt;&lt;td class='container' align='right' valign='top' colspan='2'&gt;&lt;a href='http://sourceforge.net' target='_blank'&gt;&lt;img src='http://sourceforge.net/sflogo.php?group_id=137197&amp;amp;type=1' alt='SourceForge.net' border='0' height='31' width='88'&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&quot;);</span>
<span class="fc" id="L74">        html.writeln(&quot;&lt;tr&gt;&quot;);</span>
<span class="fc" id="L75">        html.writeln(&quot;&lt;td class='container'&gt;&lt;b&gt;Things that might not be 'quite right' about your schema:&lt;/b&gt;&lt;/td&gt;&quot;);</span>
<span class="fc" id="L76">        html.writeln(&quot;&lt;td class='container' align='right'&gt;&quot;);</span>
<span class="fc" id="L77">        writeFeedMe(html);</span>
<span class="fc" id="L78">        html.writeln(&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;);</span>
<span class="fc" id="L79">        html.writeln(&quot;&lt;ul&gt;&quot;);</span>
<span class="fc" id="L80">    }</span>

    private void writeImpliedConstraints(List&lt;? extends ForeignKeyConstraint&gt; impliedConstraints, LineWriter out) throws IOException {
<span class="fc" id="L83">        out.writeln(&quot;&lt;li&gt;&quot;);</span>
<span class="fc" id="L84">        out.writeln(&quot;&lt;b&gt;Columns whose name and type imply a relationship to another table's primary key:&lt;/b&gt;&quot;);</span>
<span class="fc" id="L85">        int numDetected = 0;</span>

<span class="pc bpc" id="L87" title="1 of 2 branches missed.">        for (ForeignKeyConstraint impliedConstraint : impliedConstraints) {</span>
<span class="nc" id="L88">            Table childTable = impliedConstraint.getChildTable();</span>
<span class="nc bnc" id="L89" title="All 2 branches missed.">            if (!childTable.isView()) {</span>
<span class="nc" id="L90">                ++numDetected;</span>
            }
<span class="nc" id="L92">        }</span>

<span class="pc bpc" id="L94" title="1 of 2 branches missed.">        if (numDetected &gt; 0) {</span>
<span class="nc" id="L95">            out.writeln(&quot;&lt;table class='dataTable' border='1' rules='groups'&gt;&quot;);</span>
<span class="nc" id="L96">            out.writeln(&quot;&lt;colgroup&gt;&quot;);</span>
<span class="nc" id="L97">            out.writeln(&quot;&lt;colgroup&gt;&quot;);</span>
<span class="nc" id="L98">            out.writeln(&quot;&lt;thead align='left'&gt;&quot;);</span>
<span class="nc" id="L99">            out.writeln(&quot;&lt;tr&gt;&quot;);</span>
<span class="nc" id="L100">            out.writeln(&quot;  &lt;th&gt;Child Column&lt;/th&gt;&quot;);</span>
<span class="nc" id="L101">            out.writeln(&quot;  &lt;th&gt;Implied Parent Column&lt;/th&gt;&quot;);</span>
<span class="nc" id="L102">            out.writeln(&quot;&lt;/tr&gt;&quot;);</span>
<span class="nc" id="L103">            out.writeln(&quot;&lt;/thead&gt;&quot;);</span>
<span class="nc" id="L104">            out.writeln(&quot;&lt;tbody&gt;&quot;);</span>

<span class="nc bnc" id="L106" title="All 2 branches missed.">            for (ForeignKeyConstraint impliedConstraint : impliedConstraints) {</span>
<span class="nc" id="L107">                Table childTable = impliedConstraint.getChildTable();</span>
<span class="nc bnc" id="L108" title="All 2 branches missed.">                if (!childTable.isView()) {</span>
<span class="nc" id="L109">                    out.writeln(&quot; &lt;tr&gt;&quot;);</span>

<span class="nc" id="L111">                    out.write(&quot;  &lt;td class='detail'&gt;&quot;);</span>
<span class="nc" id="L112">                    String tableName = childTable.getName();</span>
<span class="nc" id="L113">                    out.write(&quot;&lt;a href='tables/&quot;);</span>
<span class="nc" id="L114">                    out.write(encodeHref(tableName));</span>
<span class="nc" id="L115">                    out.write(&quot;.html'&gt;&quot;);</span>
<span class="nc" id="L116">                    out.write(tableName);</span>
<span class="nc" id="L117">                    out.write(&quot;&lt;/a&gt;.&quot;);</span>
<span class="nc" id="L118">                    out.write(ForeignKeyConstraint.toString(impliedConstraint.getChildColumns()));</span>
<span class="nc" id="L119">                    out.writeln(&quot;&lt;/td&gt;&quot;);</span>

<span class="nc" id="L121">                    out.write(&quot;  &lt;td class='detail'&gt;&quot;);</span>
<span class="nc" id="L122">                    tableName = impliedConstraint.getParentTable().getName();</span>
<span class="nc" id="L123">                    out.write(&quot;&lt;a href='tables/&quot;);</span>
<span class="nc" id="L124">                    out.write(encodeHref(tableName));</span>
<span class="nc" id="L125">                    out.write(&quot;.html'&gt;&quot;);</span>
<span class="nc" id="L126">                    out.write(tableName);</span>
<span class="nc" id="L127">                    out.write(&quot;&lt;/a&gt;.&quot;);</span>
<span class="nc" id="L128">                    out.write(ForeignKeyConstraint.toString(impliedConstraint.getParentColumns()));</span>
<span class="nc" id="L129">                    out.writeln(&quot;&lt;/td&gt;&quot;);</span>

<span class="nc" id="L131">                    out.writeln(&quot; &lt;/tr&gt;&quot;);</span>
                }
<span class="nc" id="L133">            }</span>

<span class="nc" id="L135">            out.writeln(&quot;&lt;/tbody&gt;&quot;);</span>
<span class="nc" id="L136">            out.writeln(&quot;&lt;/table&gt;&quot;);</span>
        }
<span class="fc" id="L138">        writeSummary(numDetected, out);</span>
<span class="fc" id="L139">        out.writeln(&quot;&lt;p&gt;&lt;/li&gt;&quot;);</span>
<span class="fc" id="L140">    }</span>

    private void writeUniqueNullables(List&lt;TableColumn&gt; uniqueNullables, LineWriter out) throws IOException {
<span class="fc" id="L143">        out.writeln(&quot;&lt;li&gt;&quot;);</span>
<span class="fc" id="L144">        out.writeln(&quot;&lt;b&gt;Columns that are flagged as both 'nullable' and 'must be unique':&lt;/b&gt;&quot;);</span>
<span class="fc" id="L145">        writeColumnBasedAnomaly(uniqueNullables, out);</span>
<span class="fc" id="L146">        out.writeln(&quot;&lt;p&gt;&lt;/li&gt;&quot;);</span>
<span class="fc" id="L147">    }</span>

    private void writeTablesWithoutIndexes(List&lt;Table&gt; unindexedTables, LineWriter out) throws IOException {
<span class="fc" id="L150">        out.writeln(&quot;&lt;li&gt;&quot;);</span>
<span class="fc" id="L151">        out.writeln(&quot;&lt;b&gt;Tables without indexes:&lt;/b&gt;&quot;);</span>
<span class="pc bpc" id="L152" title="1 of 2 branches missed.">        if (!unindexedTables.isEmpty()) {</span>
<span class="nc" id="L153">            out.writeln(&quot;&lt;table class='dataTable' border='1' rules='groups'&gt;&quot;);</span>
<span class="nc" id="L154">            out.writeln(&quot;&lt;colgroup&gt;&quot;);</span>
<span class="nc bnc" id="L155" title="All 2 branches missed.">            if (displayNumRows)</span>
<span class="nc" id="L156">                out.writeln(&quot;&lt;colgroup&gt;&quot;);</span>
<span class="nc" id="L157">            out.writeln(&quot;&lt;thead align='left'&gt;&quot;);</span>
<span class="nc" id="L158">            out.writeln(&quot;&lt;tr&gt;&quot;);</span>
<span class="nc" id="L159">            out.write(&quot;  &lt;th&gt;Table&lt;/th&gt;&quot;);</span>
<span class="nc bnc" id="L160" title="All 2 branches missed.">            if (displayNumRows)</span>
<span class="nc" id="L161">                out.write(&quot;&lt;th&gt;Rows&lt;/th&gt;&quot;);</span>
<span class="nc" id="L162">            out.writeln();</span>
<span class="nc" id="L163">            out.writeln(&quot;&lt;/tr&gt;&quot;);</span>
<span class="nc" id="L164">            out.writeln(&quot;&lt;/thead&gt;&quot;);</span>
<span class="nc" id="L165">            out.writeln(&quot;&lt;tbody&gt;&quot;);</span>

<span class="nc bnc" id="L167" title="All 2 branches missed.">            for (Table table : unindexedTables) {</span>
<span class="nc" id="L168">                out.writeln(&quot; &lt;tr&gt;&quot;);</span>
<span class="nc" id="L169">                out.write(&quot;  &lt;td class='detail'&gt;&quot;);</span>
<span class="nc" id="L170">                out.write(&quot;&lt;a href='tables/&quot;);</span>
<span class="nc" id="L171">                out.write(encodeHref(table.getName()));</span>
<span class="nc" id="L172">                out.write(&quot;.html'&gt;&quot;);</span>
<span class="nc" id="L173">                out.write(table.getName());</span>
<span class="nc" id="L174">                out.write(&quot;&lt;/a&gt;&quot;);</span>
<span class="nc" id="L175">                out.writeln(&quot;&lt;/td&gt;&quot;);</span>
<span class="nc bnc" id="L176" title="All 2 branches missed.">                if (displayNumRows) {</span>
<span class="nc" id="L177">                    out.write(&quot;  &lt;td class='detail' align='right'&gt;&quot;);</span>
<span class="nc bnc" id="L178" title="All 2 branches missed.">                    if (!table.isView())</span>
<span class="nc" id="L179">                        out.write(String.valueOf(NumberFormat.getIntegerInstance().format(table.getNumRows())));</span>
<span class="nc" id="L180">                    out.writeln(&quot;&lt;/td&gt;&quot;);</span>
                }
<span class="nc" id="L182">                out.writeln(&quot; &lt;/tr&gt;&quot;);</span>
<span class="nc" id="L183">            }</span>

<span class="nc" id="L185">            out.writeln(&quot;&lt;/tbody&gt;&quot;);</span>
<span class="nc" id="L186">            out.writeln(&quot;&lt;/table&gt;&quot;);</span>
        }
<span class="fc" id="L188">        writeSummary(unindexedTables.size(), out);</span>
<span class="fc" id="L189">        out.writeln(&quot;&lt;p&gt;&lt;/li&gt;&quot;);</span>
<span class="fc" id="L190">    }</span>

    private void writeTablesWithIncrementingColumnNames(List&lt;Table&gt; tables, LineWriter out) throws IOException {
<span class="fc" id="L193">        out.writeln(&quot;&lt;li&gt;&quot;);</span>
<span class="fc" id="L194">        out.writeln(&quot;&lt;b&gt;Tables with incrementing column names, potentially indicating denormalization:&lt;/b&gt;&quot;);</span>
<span class="pc bpc" id="L195" title="1 of 2 branches missed.">        if (!tables.isEmpty()) {</span>
<span class="nc" id="L196">            out.writeln(&quot;&lt;table class='dataTable' border='1' rules='groups'&gt;&quot;);</span>
<span class="nc" id="L197">            out.writeln(&quot;&lt;thead align='left'&gt;&quot;);</span>
<span class="nc" id="L198">            out.writeln(&quot;&lt;tr&gt;&quot;);</span>
<span class="nc" id="L199">            out.writeln(&quot;  &lt;th&gt;Table&lt;/th&gt;&quot;);</span>
<span class="nc" id="L200">            out.writeln(&quot;&lt;/tr&gt;&quot;);</span>
<span class="nc" id="L201">            out.writeln(&quot;&lt;/thead&gt;&quot;);</span>
<span class="nc" id="L202">            out.writeln(&quot;&lt;tbody&gt;&quot;);</span>

<span class="nc bnc" id="L204" title="All 2 branches missed.">            for (Table table : tables) {</span>
<span class="nc" id="L205">                out.writeln(&quot; &lt;tr&gt;&quot;);</span>
<span class="nc" id="L206">                out.write(&quot;  &lt;td class='detail'&gt;&quot;);</span>
<span class="nc" id="L207">                out.write(&quot;&lt;a href='tables/&quot;);</span>
<span class="nc" id="L208">                out.write(encodeHref(table.getName()));</span>
<span class="nc" id="L209">                out.write(&quot;.html'&gt;&quot;);</span>
<span class="nc" id="L210">                out.write(table.getName());</span>
<span class="nc" id="L211">                out.write(&quot;&lt;/a&gt;&quot;);</span>
<span class="nc" id="L212">                out.writeln(&quot;&lt;/td&gt;&quot;);</span>
<span class="nc" id="L213">                out.writeln(&quot; &lt;/tr&gt;&quot;);</span>
<span class="nc" id="L214">            }</span>

<span class="nc" id="L216">            out.writeln(&quot;&lt;/tbody&gt;&quot;);</span>
<span class="nc" id="L217">            out.writeln(&quot;&lt;/table&gt;&quot;);</span>
        }
<span class="fc" id="L219">        writeSummary(tables.size(), out);</span>
<span class="fc" id="L220">        out.writeln(&quot;&lt;p&gt;&lt;/li&gt;&quot;);</span>
<span class="fc" id="L221">    }</span>

    private void writeTablesWithOneColumn(List&lt;Table&gt; tables, LineWriter out) throws IOException {
<span class="fc" id="L224">        out.writeln(&quot;&lt;li&gt;&quot;);</span>
<span class="fc" id="L225">        out.write(&quot;&lt;b&gt;Tables that contain a single column:&lt;/b&gt;&quot;);</span>
<span class="pc bpc" id="L226" title="1 of 2 branches missed.">        if (!tables.isEmpty()) {</span>
<span class="nc" id="L227">            out.writeln(&quot;&lt;table class='dataTable' border='1' rules='groups'&gt;&quot;);</span>
<span class="nc" id="L228">            out.writeln(&quot;&lt;colgroup&gt;&quot;);</span>
<span class="nc" id="L229">            out.writeln(&quot;&lt;colgroup&gt;&quot;);</span>
<span class="nc" id="L230">            out.writeln(&quot;&lt;thead align='left'&gt;&quot;);</span>
<span class="nc" id="L231">            out.writeln(&quot;&lt;tr&gt;&quot;);</span>
<span class="nc" id="L232">            out.writeln(&quot;  &lt;th&gt;Table&lt;/th&gt;&quot;);</span>
<span class="nc" id="L233">            out.writeln(&quot;  &lt;th&gt;Column&lt;/th&gt;&quot;);</span>
<span class="nc" id="L234">            out.writeln(&quot;&lt;/tr&gt;&quot;);</span>
<span class="nc" id="L235">            out.writeln(&quot;&lt;/thead&gt;&quot;);</span>
<span class="nc" id="L236">            out.writeln(&quot;&lt;tbody&gt;&quot;);</span>

<span class="nc bnc" id="L238" title="All 2 branches missed.">            for (Table table : tables) {</span>
<span class="nc" id="L239">                out.writeln(&quot; &lt;tr&gt;&quot;);</span>
<span class="nc" id="L240">                out.write(&quot;  &lt;td class='detail'&gt;&quot;);</span>
<span class="nc" id="L241">                out.write(&quot;&lt;a href='tables/&quot;);</span>
<span class="nc" id="L242">                out.write(encodeHref(table.getName()));</span>
<span class="nc" id="L243">                out.write(&quot;.html'&gt;&quot;);</span>
<span class="nc" id="L244">                out.write(table.getName());</span>
<span class="nc" id="L245">                out.write(&quot;&lt;/a&gt;&lt;/td&gt;&lt;td class='detail'&gt;&quot;);</span>
<span class="nc" id="L246">                out.write(table.getColumns().get(0).toString());</span>
<span class="nc" id="L247">                out.writeln(&quot;&lt;/td&gt;&quot;);</span>
<span class="nc" id="L248">                out.writeln(&quot; &lt;/tr&gt;&quot;);</span>
<span class="nc" id="L249">            }</span>

<span class="nc" id="L251">            out.writeln(&quot;&lt;/tbody&gt;&quot;);</span>
<span class="nc" id="L252">            out.writeln(&quot;&lt;/table&gt;&quot;);</span>
        }
<span class="fc" id="L254">        writeSummary(tables.size(), out);</span>
<span class="fc" id="L255">        out.writeln(&quot;&lt;p&gt;&lt;/li&gt;&quot;);</span>
<span class="fc" id="L256">    }</span>

    private void writeDefaultNullStrings(List&lt;TableColumn&gt; uniqueNullables, LineWriter out) throws IOException {
<span class="fc" id="L259">        out.writeln(&quot;&lt;li&gt;&quot;);</span>
<span class="fc" id="L260">        out.writeln(&quot;&lt;b&gt;Columns whose default value is the word 'NULL' or 'null', but the SQL NULL value may have been intended:&lt;/b&gt;&quot;);</span>
<span class="fc" id="L261">        writeColumnBasedAnomaly(uniqueNullables, out);</span>
<span class="fc" id="L262">        out.writeln(&quot;&lt;p&gt;&lt;/li&gt;&quot;);</span>
<span class="fc" id="L263">    }</span>

    private void writeColumnBasedAnomaly(List&lt;TableColumn&gt; columns, LineWriter out) throws IOException {
<span class="pc bpc" id="L266" title="1 of 2 branches missed.">        if (!columns.isEmpty()) {</span>
<span class="nc" id="L267">            out.writeln(&quot;&lt;table class='dataTable' border='1' rules='groups'&gt;&quot;);</span>
<span class="nc" id="L268">            out.writeln(&quot;&lt;thead align='left'&gt;&quot;);</span>
<span class="nc" id="L269">            out.writeln(&quot;&lt;tr&gt;&quot;);</span>
<span class="nc" id="L270">            out.writeln(&quot;  &lt;th&gt;Column&lt;/th&gt;&quot;);</span>
<span class="nc" id="L271">            out.writeln(&quot;&lt;/tr&gt;&quot;);</span>
<span class="nc" id="L272">            out.writeln(&quot;&lt;/thead&gt;&quot;);</span>
<span class="nc" id="L273">            out.writeln(&quot;&lt;tbody&gt;&quot;);</span>
<span class="nc bnc" id="L274" title="All 2 branches missed.">            for (TableColumn column : columns) {</span>
<span class="nc" id="L275">                out.writeln(&quot; &lt;tr&gt;&quot;);</span>
<span class="nc" id="L276">                out.write(&quot;  &lt;td class='detail'&gt;&quot;);</span>
<span class="nc" id="L277">                String tableName = column.getTable().getName();</span>
<span class="nc" id="L278">                out.write(&quot;&lt;a href='tables/&quot;);</span>
<span class="nc" id="L279">                out.write(encodeHref(tableName));</span>
<span class="nc" id="L280">                out.write(&quot;.html'&gt;&quot;);</span>
<span class="nc" id="L281">                out.write(tableName);</span>
<span class="nc" id="L282">                out.write(&quot;&lt;/a&gt;.&quot;);</span>
<span class="nc" id="L283">                out.write(column.getName());</span>
<span class="nc" id="L284">                out.writeln(&quot;&lt;/td&gt;&quot;);</span>
<span class="nc" id="L285">                out.writeln(&quot; &lt;/tr&gt;&quot;);</span>
<span class="nc" id="L286">            }</span>

<span class="nc" id="L288">            out.writeln(&quot;&lt;/tbody&gt;&quot;);</span>
<span class="nc" id="L289">            out.writeln(&quot;&lt;/table&gt;&quot;);</span>
        }
<span class="fc" id="L291">        writeSummary(columns.size(), out);</span>
<span class="fc" id="L292">    }</span>

    private void writeSummary(int numAnomalies, LineWriter out) throws IOException {
<span class="pc bpc" id="L295" title="2 of 3 branches missed.">        switch (numAnomalies) {</span>
            case 0:
<span class="fc" id="L297">                out.write(&quot;&lt;br&gt;Anomaly not detected&quot;);</span>
<span class="fc" id="L298">                break;</span>
            case 1:
<span class="nc" id="L300">                out.write(&quot;1 instance of anomaly detected&quot;);</span>
<span class="nc" id="L301">                break;</span>
            default:
<span class="nc" id="L303">                out.write(numAnomalies + &quot; instances of anomaly detected&quot;);</span>
        }
<span class="fc" id="L305">    }</span>

    @Override
    protected void writeFooter(LineWriter out) throws IOException {
<span class="fc" id="L309">        out.writeln(&quot;&lt;/ul&gt;&quot;);</span>
<span class="fc" id="L310">        super.writeFooter(out);</span>
<span class="fc" id="L311">    }</span>

    @Override
    protected boolean isAnomaliesPage() {
<span class="fc" id="L315">        return true;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>